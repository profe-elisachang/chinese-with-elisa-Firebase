# Changelog

## [2024] - 新增 Studio.html 管理頁面

### 新增功能

#### 核心功能
- ✨ 新增 `courses/shizi/studio.html` - 識字課程管理 Studio 頁面
  - 左右分欄編輯介面（編輯面板 + 實時預覽面板）
  - 可拖拽分隔線調整左右面板寬度（5%-60%）
  - 編輯面板可最小化至 60px（僅顯示標題）

#### 頂部控制區
- ✨ 等級/類型/課次選擇器
  - 移除「等級」選單，簡化為只保留「類型」（部件/目標字）和「課次」（Lesson 1-25）
  - 資料直接從 `lessons/lesson1` 到 `lessons/lesson25` 讀取

#### 編輯功能
- ✨ 左側編輯面板
  - 表單卡片預設折疊狀態，只顯示字或補丁圖片（大字體 2rem）
  - 點擊卡片標題可展開/折疊（顯示 ▶/▼ 圖標）
  - 拖拽排序功能（更新 order 欄位）
  - 自動保存功能（防抖 1 秒）
  - 新增項目功能（+ 新增按鈕）
  - 全部展開/全部折疊按鈕（低調的上下箭頭圖標 ↑/↓）

#### 表單欄位
- ✨ 完整的表單欄位支援（對齊 structure.md V2.2）
  - 核心文字區：character, display_image, pinyin, meaning, type
  - 教學支援區：components_breakdown, book_explanation, story, pronunciation_cue, image, phrases, example
  - 管理欄位：lesson, is_published, order

#### 發布功能
- ✨ 發布狀態管理
  - Toggle Switch（滑動開關）位於標題區域
  - 折疊狀態下即可切換發布狀態
  - 已發布/未發布狀態顯示

#### 刪除功能
- ✨ 刪除按鈕位置調整
  - 從標題區域移至展開後的表單內容區域底部
  - 只有在展開狀態下才能看到和點擊，避免誤刪
  - 全寬紅色按鈕樣式

#### 實時預覽
- ✨ 右側預覽面板
  - 使用 `lesson.html` 的 `character-card` 樣式
  - 與學生端顯示一致
  - 支援字形補丁系統（對齊 structure.md）

#### 互動功能
- ✨ 點擊卡片跳轉功能
  - 單擊右側預覽卡片：自動展開對應的左側表單卡片、滾動到該位置、高亮顯示（3 秒後自動移除）
  - 雙擊右側預覽卡片：開啟教學模態框（65 寸電視全螢幕展示）

#### 教學模態框（65 寸電視）
- ✨ 全螢幕教學展示
  - 點擊背景遮罩層即可關閉（無需移動滑鼠到關閉按鈕）
  - 大字體響應式設計（使用 clamp()）
  - 字形補丁固定 120px（65 寸電視規格）
  - 鍵盤導航：← → 切換字卡，Esc 關閉
  - 顯示所有支援內容（部件拆解、書本解釋、記憶故事、發音提示等）

#### Markdown 支援
- ✨ Markdown 渲染
  - 使用 Marked.js 渲染
  - 圖片分類：`![comp]`, `![origin]`, `![story]`（對齊 structure.md）
  - 空值隱藏原則：空欄位不顯示容器

#### Firebase 整合
- ✨ 資料讀取與保存
  - 從 `lessons/${lessonId}` 讀取資料
  - 自動保存（防抖 1 秒）
  - 支援匿名登入

#### 響應式設計
- ✨ 多螢幕支援
  - 32 寸螢幕（家用編輯）：舒適的編輯介面
  - 15 寸筆電（現場教學）：可最小化編輯面板
  - 65 寸電視（教學展示）：全螢幕模態框
  - 移動端自動切換為上下分欄

### 設計改進

#### 視覺設計
- 🎨 低調的批量操作按鈕
  - 全部展開/折疊按鈕改為簡單的上下箭頭圖標（↑/↓）
  - 小尺寸（28px × 28px）、透明背景、半透明邊框
  - 懸停時才顯示明顯效果，適合課堂使用，不會吸引學生注意力

#### 使用者體驗
- 🎨 展開/折疊視覺提示
  - 折疊狀態顯示 ▶ 圖標
  - 展開狀態顯示 ▼ 圖標（旋轉 90 度）
  - 滑鼠懸停時標題區域背景變色提示可點擊

- 🎨 高亮顯示
  - 點擊卡片跳轉時，對應的表單卡片會高亮顯示（邊框和背景色）
  - 3 秒後自動移除高亮

### 技術細節

#### 對齊規範
- ✅ 對齊 `structure.md` V2.2 資料結構規範
- ✅ 使用全局導航系統（nav-global.css/js）
- ✅ 使用與 `lesson.html` 一致的 CSS 變數系統
- ✅ 符合 Admin 情境的渲染規範

#### 字形補丁系統
- ✅ 優先檢查 `display_image` 欄位
- ✅ Admin 情境：行內顯示，高度 `1.8em`（約 35px）
- ✅ 教學模態框（65 寸電視）：固定 120px

#### 圖片處理
- ✅ Markdown 圖片分類（Alt-based）
- ✅ 字形補丁、象形演變圖、故事插圖自動分類

### 檔案變更

#### 新增檔案
- `courses/shizi/studio.html` - 全新的 Studio 管理頁面

#### 未變更檔案
- 所有現有檔案保持不變，僅新增 studio.html

---

## Commit Message

```
feat: 新增識字課程管理 Studio 頁面

新增功能：
- 左右分欄編輯介面（可拖拽調整寬度、可最小化）
- 表單卡片預設折疊，點擊展開/折疊
- 單擊預覽卡片跳轉到對應編輯欄位
- 雙擊預覽卡片開啟教學模態框（65寸電視）
- 全部展開/折疊功能（低調箭頭圖標）
- 發布狀態 Toggle Switch（標題區域）
- 刪除按鈕移至展開後（避免誤刪）
- 點擊背景關閉模態框
- 自動保存（防抖 1 秒）
- 拖拽排序功能

設計改進：
- 移除等級選單，簡化為類型+課次
- 低調的批量操作按鈕（適合課堂使用）
- 展開/折疊視覺提示
- 高亮顯示跳轉目標

技術規範：
- 對齊 structure.md V2.2 資料結構
- 使用全局導航系統
- 支援多螢幕尺寸（32寸/15寸/65寸）
- 字形補丁系統（Admin: 1.8em, TV: 120px）
- Markdown 渲染與圖片分類

檔案：
- 新增: courses/shizi/studio.html
- 未變更任何現有檔案
```

